#!/bin/bash
set -x
em++ -I ../Simulator/Sketch -I ../UziFirmware -fdeclspec -s LLD_REPORT_UNDEFINED main.c ../Simulator/Sketch/Arduino.cpp ../Simulator/Sketch/EEPROM.cpp ../Simulator/Sketch/Servo.cpp ../Simulator/Sketch/Simulator.cpp ../UziFirmware/ArrayReader.cpp ../UziFirmware/Coroutine.cpp ../UziFirmware/EEPROMReader.cpp ../UziFirmware/EEPROMWearLevelingReader.cpp ../UziFirmware/EEPROMWearLevelingWriter.cpp ../UziFirmware/EEPROMWriter.cpp ../UziFirmware/GPIO.cpp ../UziFirmware/Instruction.cpp ../UziFirmware/Memory.cpp ../UziFirmware/Monitor.cpp ../UziFirmware/Program.cpp ../UziFirmware/Reader.cpp ../UziFirmware/Script.cpp ../UziFirmware/SerialReader.cpp ../UziFirmware/UziSerial.cpp ../UziFirmware/VM.cpp -x c++ ../UziFirmware/UziFirmware.ino -o ../../gui/ide/simulator.js -s EXPORTED_FUNCTIONS=_GPIO_getPinValue,_GPIO_setPinValue,_Sketch_setup,_Sketch_loop,_Serial_readInto,_Serial_write,_Sketch_getMillis,_Sketch_setMillis,_EEPROM_read,_EEPROM_write,_EEPROM_size,_Stats_usedMemory,_Stats_coroutineResizeCounter,_main,_malloc,_free -s EXPORTED_RUNTIME_METHODS=ccall,cwrap --post-js bindings.js

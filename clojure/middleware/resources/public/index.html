<html>
  <body>
    <script src="libs/jquery/jquery-1.12.4.min.js" type="text/javascript"></script>
    <!--<script src="ajax.js" type="text/javascript"></script>-->

    <script src="ide/ajax.js" type="text/javascript"></script>
    <script src="ide/uzi.js" type="text/javascript" ></script>

    <script>
    $(document).ready(function () {
      Uzi.start().then(() => {
        console.log("Uzi started successfully!");
        console.log(Uzi.state);
        Uzi.on("update", function () {
          console.log(Uzi.state);
        })
      });
    });
    </script>
    <script>
      /*
      function log(data) { console.log(data); }

      function POST(url, data) {
        return ajax.POST(url, data);
      }

      function connect(portName) {
        POST("/connect", {port: portName}).then(log);
      }

      function disconnect() {
        POST("/disconnect", {}).then(log);
      }

      function compile(src, libs) {
        POST("/compile", {src: src, libs: libs || "uzi/libraries"}).then(log);
      }

      function analogRead() {
        var socket = new WebSocket('ws://localhost:3000/analog-read');
        socket.onopen = function() {
          console.log('connected to server');
          socket.onmessage = function(evt) { console.log(evt); };
          socket.onclose = function() { console.log('disconnected from server'); };
        };
        return socket;
      }

      function uziEventLoop() {
        let socket = new WebSocket("ws://" + location.host + "/uzi");
        socket.onopen = function () {
          socket.onmessage = function (evt) {
            try {
              let data = JSON.parse(evt.data);
              console.log(data);
            } catch (e) {
              console.log(e);
            }
          };
          socket.onclose = function() { console.log('disconnected from server'); };
        }
        return socket;
      }
      */
    </script>
  </body>
</html>
